[debug] [2025-09-07T15:42:57.548Z] ----------------------------------------------------------------------
[debug] [2025-09-07T15:42:57.553Z] Command:       /Users/kunchoktashi/.nvm/versions/node/v22.9.0/bin/node /Users/kunchoktashi/.nvm/versions/node/v22.9.0/bin/firebase deploy --only functions --debug
[debug] [2025-09-07T15:42:57.553Z] CLI Version:   13.34.0
[debug] [2025-09-07T15:42:57.553Z] Platform:      darwin
[debug] [2025-09-07T15:42:57.553Z] Node Version:  v22.9.0
[debug] [2025-09-07T15:42:57.553Z] Time:          Sun Sep 07 2025 11:42:57 GMT-0400 (Eastern Daylight Time)
[debug] [2025-09-07T15:42:57.553Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-09-07T15:42:57.645Z] Field "/functions" in "firebase.json" is possibly invalid: must be object
[debug] [2025-09-07T15:42:57.646Z] Object "/functions/0" in "firebase.json" has unknown property: {"additionalProperty":"region"}
[debug] [2025-09-07T15:42:57.646Z] Field "/functions" in "firebase.json" is possibly invalid: must match a schema in anyOf
[debug] [2025-09-07T15:42:57.649Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-09-07T15:42:57.649Z] > authorizing via signed-in user (khakontas33@gmail.com)
[debug] [2025-09-07T15:42:57.649Z] [iam] checking project tibetan-keyboard for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2025-09-07T15:42:57.650Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:57.650Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:57.650Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard:testIamPermissions [none]
[debug] [2025-09-07T15:42:57.650Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard:testIamPermissions x-goog-quota-user=projects/tibetan-keyboard
[debug] [2025-09-07T15:42:57.650Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-09-07T15:42:57.934Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard:testIamPermissions 200
[debug] [2025-09-07T15:42:57.934Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-09-07T15:42:57.935Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:57.935Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:57.935Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/tibetan-keyboard/serviceAccounts/tibetan-keyboard@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2025-09-07T15:42:57.935Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/tibetan-keyboard/serviceAccounts/tibetan-keyboard@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2025-09-07T15:42:58.199Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/tibetan-keyboard/serviceAccounts/tibetan-keyboard@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2025-09-07T15:42:58.199Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/tibetan-keyboard/serviceAccounts/tibetan-keyboard@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'tibetan-keyboard'...
[info] 
[info] i  deploying functions 
[info] Running command: npm --prefix "$RESOURCE_DIR" run lint
[info] Running command: npm --prefix "$RESOURCE_DIR" run build
[info] ✔  functions: Finished running predeploy script. 
[debug] [2025-09-07T15:42:59.220Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:59.220Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:59.220Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard [none]
[debug] [2025-09-07T15:42:59.305Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard 200
[debug] [2025-09-07T15:42:59.305Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard {"projectNumber":"116616062750","projectId":"tibetan-keyboard","lifecycleState":"ACTIVE","name":"Tibetan Keyboard","labels":{"firebase":"enabled","generative-language":"enabled"},"createTime":"2021-07-31T05:43:52.603Z"}
[info] i  functions: preparing codebase default for deployment 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[debug] [2025-09-07T15:42:59.306Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:59.306Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:59.306Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:59.306Z] Checked if tokens are valid: true, expires at: 1757262334546
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[debug] [2025-09-07T15:42:59.306Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:59.306Z] Checked if tokens are valid: true, expires at: 1757262334546
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2025-09-07T15:42:59.306Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:59.306Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:59.306Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/cloudfunctions.googleapis.com [none]
[debug] [2025-09-07T15:42:59.306Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/cloudfunctions.googleapis.com x-goog-quota-user=projects/tibetan-keyboard
[debug] [2025-09-07T15:42:59.307Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/runtimeconfig.googleapis.com [none]
[debug] [2025-09-07T15:42:59.307Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/runtimeconfig.googleapis.com x-goog-quota-user=projects/tibetan-keyboard
[debug] [2025-09-07T15:42:59.308Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/cloudbuild.googleapis.com [none]
[debug] [2025-09-07T15:42:59.308Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/cloudbuild.googleapis.com x-goog-quota-user=projects/tibetan-keyboard
[debug] [2025-09-07T15:42:59.308Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/artifactregistry.googleapis.com [none]
[debug] [2025-09-07T15:42:59.309Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/artifactregistry.googleapis.com x-goog-quota-user=projects/tibetan-keyboard
[debug] [2025-09-07T15:42:59.705Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/cloudbuild.googleapis.com 200
[debug] [2025-09-07T15:42:59.705Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/cloudbuild.googleapis.com [omitted]
[info] ✔  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2025-09-07T15:42:59.706Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/runtimeconfig.googleapis.com 200
[debug] [2025-09-07T15:42:59.706Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/runtimeconfig.googleapis.com [omitted]
[debug] [2025-09-07T15:42:59.707Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/cloudfunctions.googleapis.com 200
[debug] [2025-09-07T15:42:59.708Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/cloudfunctions.googleapis.com [omitted]
[info] ✔  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2025-09-07T15:42:59.708Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/artifactregistry.googleapis.com 200
[debug] [2025-09-07T15:42:59.709Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/tibetan-keyboard/services/artifactregistry.googleapis.com [omitted]
[info] ✔  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2025-09-07T15:42:59.709Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:59.709Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:42:59.709Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/tibetan-keyboard/adminSdkConfig [none]
[debug] [2025-09-07T15:43:00.108Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/tibetan-keyboard/adminSdkConfig 200
[debug] [2025-09-07T15:43:00.108Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/tibetan-keyboard/adminSdkConfig {"projectId":"tibetan-keyboard","storageBucket":"tibetan-keyboard.firebasestorage.app"}
[debug] [2025-09-07T15:43:00.109Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:00.109Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:00.109Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tibetan-keyboard/configs [none]
[debug] [2025-09-07T15:43:00.323Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tibetan-keyboard/configs 200
[debug] [2025-09-07T15:43:00.324Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tibetan-keyboard/configs {}
[debug] [2025-09-07T15:43:00.326Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[warn] ⚠  functions: Please note that there will be breaking changes when you upgrade. 
[debug] [2025-09-07T15:43:00.786Z] > [functions] package.json contents: {
  "name": "tibetan-keyboard-api-service",
  "version": "1.0.0",
  "description": "Cloud Function for translation and grammar checking with user limits",
  "main": "lib/index.js",
  "scripts": {
    "build": "tsc",
    "lint": "echo 'Linting skipped'",
    "serve": "lsof -ti :5001 | xargs kill -9 && npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "22"
  },
  "dependencies": {
    "@google-cloud/translate": "^8.0.2",
    "axios": "^1.6.2",
    "cors": "^2.8.5",
    "express": "^4.18.2",
    "express-rate-limit": "^7.1.5",
    "firebase-admin": "^11.11.0",
    "firebase-functions": "^4.5.0",
    "google-translate-api-x": "^10.7.2",
    "helmet": "^7.1.0",
    "joi": "^17.11.0"
  },
  "devDependencies": {
    "@types/cors": "^2.8.17",
    "@types/express": "^4.17.21",
    "@types/node": "^20.8.7",
    "typescript": "^5.2.2"
  }
}
[debug] [2025-09-07T15:43:00.787Z] Building nodejs source
[info] i  functions: Loading and analyzing source code for codebase default to determine what to deploy 
[info] i  functions: You are using a version of firebase-functions SDK (4.9.0) that does not have support for the newest Firebase Extensions features. Please update firebase-functions SDK to >=5.1.0 to use them correctly 
[debug] [2025-09-07T15:43:00.787Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-09-07T15:43:00.793Z] Found firebase-functions binary at '/Users/kunchoktashi/dev/android/Tibetan-Keyboard/api-backend/node_modules/.bin/firebase-functions'
[info] Serving at port 8595

[debug] [2025-09-07T15:43:01.055Z] Got response from /__/functions.yaml {"endpoints":{"api":{"platform":"gcfv1","availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"serviceAccountEmail":null,"vpc":null,"httpsTrigger":{},"entryPoint":"api"}},"specVersion":"v1alpha1","requiredAPIs":[]}
[info] i  functions: Loaded environment variables from .env. 
[info] i  functions: preparing . directory for uploading... 
[info] i  functions: packaged /Users/kunchoktashi/dev/android/Tibetan-Keyboard/api-backend (69.48 KB) for uploading 
[debug] [2025-09-07T15:43:05.121Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:05.121Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:05.121Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/tibetan-keyboard/locations/-/functions [none]
[debug] [2025-09-07T15:43:05.638Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/tibetan-keyboard/locations/-/functions 200
[debug] [2025-09-07T15:43:05.638Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/tibetan-keyboard/locations/-/functions {}
[debug] [2025-09-07T15:43:05.639Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:05.639Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:05.640Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/tibetan-keyboard/locations/-/functions filter=environment%3D%22GEN_2%22
[debug] [2025-09-07T15:43:06.153Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/tibetan-keyboard/locations/-/functions 200
[debug] [2025-09-07T15:43:06.153Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/tibetan-keyboard/locations/-/functions {}
[debug] [2025-09-07T15:43:06.156Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:06.157Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:06.157Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard [none]
[debug] [2025-09-07T15:43:06.306Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard 200
[debug] [2025-09-07T15:43:06.307Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard {"projectNumber":"116616062750","projectId":"tibetan-keyboard","lifecycleState":"ACTIVE","name":"Tibetan Keyboard","labels":{"firebase":"enabled","generative-language":"enabled"},"createTime":"2021-07-31T05:43:52.603Z"}
[debug] [2025-09-07T15:43:06.309Z] [functions] found 1 new HTTP functions, testing setIamPolicy permission...
[debug] [2025-09-07T15:43:06.309Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:06.309Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:06.310Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard:testIamPermissions [none]
[debug] [2025-09-07T15:43:06.310Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard:testIamPermissions x-goog-quota-user=projects/tibetan-keyboard
[debug] [2025-09-07T15:43:06.310Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard:testIamPermissions {"permissions":["cloudfunctions.functions.setIamPolicy"]}
[debug] [2025-09-07T15:43:06.470Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard:testIamPermissions 200
[debug] [2025-09-07T15:43:06.470Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tibetan-keyboard:testIamPermissions {"permissions":["cloudfunctions.functions.setIamPolicy"]}
[debug] [2025-09-07T15:43:06.470Z] [functions] found setIamPolicy permission, proceeding with deploy
[debug] [2025-09-07T15:43:06.471Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:06.471Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:06.471Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v1/projects/tibetan-keyboard/locations/us-central1/functions:generateUploadUrl [none]
[debug] [2025-09-07T15:43:06.471Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/tibetan-keyboard/locations/us-central1/functions:generateUploadUrl {}
[debug] [2025-09-07T15:43:07.073Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v1/projects/tibetan-keyboard/locations/us-central1/functions:generateUploadUrl 200
[debug] [2025-09-07T15:43:07.073Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/tibetan-keyboard/locations/us-central1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/uploads-536820116004.us-central1.cloudfunctions.appspot.com/f93d2436-ae84-4698-939c-5d27184876c8.zip?GoogleAccessId=service-116616062750@gcf-admin-robot.iam.gserviceaccount.com&Expires=1757261586&Signature=TZwNnDlhuqYE2w4Kbp7lNmeSMx3HxIgbUp%2B1KjA7uboPUJkPQLQAiRIM4XieBJq%2BuwwBiz4EgsEg4V9KI7fS%2BlkPuKaYWmG9Ap5ilJE2%2BaWOXEUa1WCpFsQ2bFeCof1O6N88FFZ1QvAWZimFlOP2cwtbi371J6NZMOaOSHj9KAvbt7nmuD%2Fr%2BD5XCI1EfFHRXzkay1isOFn%2Bzqg6sDToj%2B3NqHAOYZDwQgiXBqWwnHwg0qpHUMHdwQzj4RdaJhweeJnAk24chIGJxmsZSzzpcQUljdZl%2FrVIfwREelLWF%2FTv9sq5%2B0eYHKlamyGB0dB1QQWd%2B5%2Bkjf30YFpuTx%2Bs4w%3D%3D"}
[debug] [2025-09-07T15:43:07.077Z] >>> [apiv2][query] PUT https://storage.googleapis.com/uploads-536820116004.us-central1.cloudfunctions.appspot.com/f93d2436-ae84-4698-939c-5d27184876c8.zip GoogleAccessId=service-116616062750%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1757261586&Signature=TZwNnDlhuqYE2w4Kbp7lNmeSMx3HxIgbUp%2B1KjA7uboPUJkPQLQAiRIM4XieBJq%2BuwwBiz4EgsEg4V9KI7fS%2BlkPuKaYWmG9Ap5ilJE2%2BaWOXEUa1WCpFsQ2bFeCof1O6N88FFZ1QvAWZimFlOP2cwtbi371J6NZMOaOSHj9KAvbt7nmuD%2Fr%2BD5XCI1EfFHRXzkay1isOFn%2Bzqg6sDToj%2B3NqHAOYZDwQgiXBqWwnHwg0qpHUMHdwQzj4RdaJhweeJnAk24chIGJxmsZSzzpcQUljdZl%2FrVIfwREelLWF%2FTv9sq5%2B0eYHKlamyGB0dB1QQWd%2B5%2Bkjf30YFpuTx%2Bs4w%3D%3D
[debug] [2025-09-07T15:43:07.077Z] >>> [apiv2][body] PUT https://storage.googleapis.com/uploads-536820116004.us-central1.cloudfunctions.appspot.com/f93d2436-ae84-4698-939c-5d27184876c8.zip [stream]
[debug] [2025-09-07T15:43:07.384Z] <<< [apiv2][status] PUT https://storage.googleapis.com/uploads-536820116004.us-central1.cloudfunctions.appspot.com/f93d2436-ae84-4698-939c-5d27184876c8.zip 200
[debug] [2025-09-07T15:43:07.384Z] <<< [apiv2][body] PUT https://storage.googleapis.com/uploads-536820116004.us-central1.cloudfunctions.appspot.com/f93d2436-ae84-4698-939c-5d27184876c8.zip [omitted]
[info] ✔  functions: . folder uploaded successfully 
[info] i  functions: creating Node.js 22 (1st Gen) function api(us-central1)... 
[debug] [2025-09-07T15:43:07.389Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:07.389Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:07.390Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v1/projects/tibetan-keyboard/locations/us-central1/functions [none]
[debug] [2025-09-07T15:43:07.390Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/tibetan-keyboard/locations/us-central1/functions {"name":"projects/tibetan-keyboard/locations/us-central1/functions/api","sourceUploadUrl":"https://storage.googleapis.com/uploads-536820116004.us-central1.cloudfunctions.appspot.com/f93d2436-ae84-4698-939c-5d27184876c8.zip?GoogleAccessId=service-116616062750@gcf-admin-robot.iam.gserviceaccount.com&Expires=1757261586&Signature=TZwNnDlhuqYE2w4Kbp7lNmeSMx3HxIgbUp%2B1KjA7uboPUJkPQLQAiRIM4XieBJq%2BuwwBiz4EgsEg4V9KI7fS%2BlkPuKaYWmG9Ap5ilJE2%2BaWOXEUa1WCpFsQ2bFeCof1O6N88FFZ1QvAWZimFlOP2cwtbi371J6NZMOaOSHj9KAvbt7nmuD%2Fr%2BD5XCI1EfFHRXzkay1isOFn%2Bzqg6sDToj%2B3NqHAOYZDwQgiXBqWwnHwg0qpHUMHdwQzj4RdaJhweeJnAk24chIGJxmsZSzzpcQUljdZl%2FrVIfwREelLWF%2FTv9sq5%2B0eYHKlamyGB0dB1QQWd%2B5%2Bkjf30YFpuTx%2Bs4w%3D%3D","entryPoint":"api","runtime":"nodejs22","dockerRegistry":"ARTIFACT_REGISTRY","labels":{"deployment-tool":"cli-firebase","firebase-functions-hash":"be17546aae28970182caafaae970563fdd170b1b"},"httpsTrigger":{"securityLevel":"SECURE_ALWAYS"},"minInstances":null,"maxInstances":null,"ingressSettings":null,"environmentVariables":{"GOOGLE_CLOUD_PROJECT_ID":"tibetan-keyboard","GOOGLE_APPLICATION_CREDENTIALS":"./tibetan-keyboard.json","ALLOWED_ORIGINS":"http://localhost:3000,https://kharagedition.com","NODE_ENV":"production","FIREBASE_CONFIG":"{\"projectId\":\"tibetan-keyboard\",\"storageBucket\":\"tibetan-keyboard.firebasestorage.app\"}","GCLOUD_PROJECT":"tibetan-keyboard","EVENTARC_CLOUD_EVENT_SOURCE":"projects/tibetan-keyboard/locations/us-central1/functions/api"},"serviceAccountEmail":null,"availableMemoryMb":null,"timeout":null,"vpcConnector":null,"vpcConnectorEgressSettings":null,"buildEnvironmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""}}
[debug] [2025-09-07T15:43:07.593Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v1/projects/tibetan-keyboard/locations/us-central1/functions 400
[debug] [2025-09-07T15:43:07.593Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/tibetan-keyboard/locations/us-central1/functions {"error":{"code":400,"message":"Failed to create 1st Gen function projects/tibetan-keyboard/locations/us-central1/functions/api: runtime: Runtime validation errors: [error_code: \t INVALID_RUNTIME\nmessage: \"Runtime \\\"nodejs22\\\" is not supported on GCF Gen1\"\n]","status":"INVALID_ARGUMENT"}}
[warn] ⚠  functions: failed to create function projects/tibetan-keyboard/locations/us-central1/functions/api 
[error] Failed to create function projects/tibetan-keyboard/locations/us-central1/functions/api
[debug] [2025-09-07T15:43:07.595Z] Total Function Deployment time: 207
[debug] [2025-09-07T15:43:07.595Z] 1 Functions Deployed
[debug] [2025-09-07T15:43:07.595Z] 1 Functions Errored
[debug] [2025-09-07T15:43:07.595Z] 0 Function Deployments Aborted
[debug] [2025-09-07T15:43:07.595Z] Average Function Deployment time: 206
[info] 
[info] Functions deploy had errors with the following functions:
	api(us-central1)
[debug] [2025-09-07T15:43:07.596Z] Not printing URL for HTTPS function. Typically this means it didn't match a filter or we failed deployment
[info] i  functions: cleaning up build files... 
[debug] [2025-09-07T15:43:07.596Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:07.596Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:07.597Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:07.597Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:07.597Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/tibetan-keyboard/locations/us-central1/repositories/gcf-artifacts/packages/api [none]
[debug] [2025-09-07T15:43:07.598Z] >>> [apiv2][query] GET https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list [none]
[debug] [2025-09-07T15:43:07.773Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/tibetan-keyboard/locations/us-central1/repositories/gcf-artifacts/packages/api 404
[debug] [2025-09-07T15:43:07.774Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/tibetan-keyboard/locations/us-central1/repositories/gcf-artifacts/packages/api {"error":{"code":404,"message":"Package \"projects/tibetan-keyboard/locations/us-central1/repositories/gcf-artifacts/packages/api\" was not found.","status":"NOT_FOUND"}}
[debug] [2025-09-07T15:43:07.903Z] <<< [apiv2][status] GET https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list 404
[debug] [2025-09-07T15:43:07.903Z] <<< [apiv2][body] GET https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list {"errors":[{"code":"NAME_UNKNOWN","message":"Repository \"us.gcr.io\" not found"}]}
[debug] [2025-09-07T15:43:07.904Z] Failed docker command with error  Request to https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list had HTTP Error: 404, Not Found {"name":"FirebaseError","children":[],"context":{"body":{"errors":[{"code":"NAME_UNKNOWN","message":"Repository \"us.gcr.io\" not found"}],"error":{"message":"Not Found"}},"response":{"statusCode":404}},"exit":1,"message":"Request to https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list had HTTP Error: 404, Not Found","status":404}
[debug] [2025-09-07T15:43:07.906Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:07.907Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:07.907Z] >>> [apiv2][query] GET https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list [none]
[debug] [2025-09-07T15:43:08.086Z] <<< [apiv2][status] GET https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list 404
[debug] [2025-09-07T15:43:08.086Z] <<< [apiv2][body] GET https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list {"errors":[{"code":"NAME_UNKNOWN","message":"Repository \"us.gcr.io\" not found"}]}
[debug] [2025-09-07T15:43:08.086Z] Failed docker command with error  Request to https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list had HTTP Error: 404, Not Found {"name":"FirebaseError","children":[],"context":{"body":{"errors":[{"code":"NAME_UNKNOWN","message":"Repository \"us.gcr.io\" not found"}],"error":{"message":"Not Found"}},"response":{"statusCode":404}},"exit":1,"message":"Request to https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list had HTTP Error: 404, Not Found","status":404}
[debug] [2025-09-07T15:43:08.187Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:08.188Z] Checked if tokens are valid: true, expires at: 1757262334546
[debug] [2025-09-07T15:43:08.188Z] >>> [apiv2][query] GET https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list [none]
[debug] [2025-09-07T15:43:08.356Z] <<< [apiv2][status] GET https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list 404
[debug] [2025-09-07T15:43:08.357Z] <<< [apiv2][body] GET https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list {"errors":[{"code":"NAME_UNKNOWN","message":"Repository \"us.gcr.io\" not found"}]}
[debug] [2025-09-07T15:43:08.357Z] Failed docker command with error  Request to https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list had HTTP Error: 404, Not Found {"name":"FirebaseError","children":[],"context":{"body":{"errors":[{"code":"NAME_UNKNOWN","message":"Repository \"us.gcr.io\" not found"}],"error":{"message":"Not Found"}},"response":{"statusCode":404}},"exit":1,"message":"Request to https://us.gcr.io/v2/tibetan-keyboard/gcf/us-central1/tags/list had HTTP Error: 404, Not Found","status":404}
[warn] ⚠  functions: Unhandled error cleaning up build images. This could result in a small monthly bill if not corrected. You can attempt to delete these images by redeploying or you can delete them manually at https://console.cloud.google.com/gcr/images/tibetan-keyboard/us/gcf 
[debug] [2025-09-07T15:43:08.358Z] Functions deploy failed.
[debug] [2025-09-07T15:43:08.358Z] {
  "endpoint": {
    "id": "api",
    "project": "tibetan-keyboard",
    "region": "us-central1",
    "entryPoint": "api",
    "platform": "gcfv1",
    "runtime": "nodejs22",
    "httpsTrigger": {},
    "ingressSettings": null,
    "availableMemoryMb": null,
    "serviceAccount": null,
    "timeoutSeconds": null,
    "maxInstances": null,
    "minInstances": null,
    "vpc": null,
    "environmentVariables": {
      "GOOGLE_CLOUD_PROJECT_ID": "tibetan-keyboard",
      "GOOGLE_APPLICATION_CREDENTIALS": "./tibetan-keyboard.json",
      "ALLOWED_ORIGINS": "http://localhost:3000,https://kharagedition.com",
      "NODE_ENV": "production",
      "FIREBASE_CONFIG": "{\"projectId\":\"tibetan-keyboard\",\"storageBucket\":\"tibetan-keyboard.firebasestorage.app\"}",
      "GCLOUD_PROJECT": "tibetan-keyboard",
      "EVENTARC_CLOUD_EVENT_SOURCE": "projects/tibetan-keyboard/locations/us-central1/functions/api"
    },
    "codebase": "default",
    "targetedByOnly": false,
    "hash": "be17546aae28970182caafaae970563fdd170b1b",
    "labels": {
      "deployment-tool": "cli-firebase"
    }
  },
  "op": "create",
  "original": {
    "name": "FirebaseError",
    "children": [],
    "context": {
      "function": "projects/tibetan-keyboard/locations/us-central1/functions/api"
    },
    "exit": 1,
    "message": "Failed to create function projects/tibetan-keyboard/locations/us-central1/functions/api",
    "original": {
      "name": "FirebaseError",
      "children": [],
      "context": {
        "body": {
          "error": {
            "code": 400,
            "message": "Failed to create 1st Gen function projects/tibetan-keyboard/locations/us-central1/functions/api: runtime: Runtime validation errors: [error_code: \t INVALID_RUNTIME\nmessage: \"Runtime \\\"nodejs22\\\" is not supported on GCF Gen1\"\n]",
            "status": "INVALID_ARGUMENT"
          }
        },
        "response": {
          "statusCode": 400
        }
      },
      "exit": 1,
      "message": "Request to https://cloudfunctions.googleapis.com/v1/projects/tibetan-keyboard/locations/us-central1/functions had HTTP Error: 400, Failed to create 1st Gen function projects/tibetan-keyboard/locations/us-central1/functions/api: runtime: Runtime validation errors: [error_code: \t INVALID_RUNTIME\nmessage: \"Runtime \\\"nodejs22\\\" is not supported on GCF Gen1\"\n]",
      "status": 400
    },
    "status": 400,
    "code": 400
  }
}
[debug] [2025-09-07T15:43:08.359Z] Error: Failed to create function api in region us-central1
    at /Users/kunchoktashi/.nvm/versions/node/v22.9.0/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:52:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Fabricator.createV1Function (/Users/kunchoktashi/.nvm/versions/node/v22.9.0/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:182:32)
    at async Fabricator.createEndpoint (/Users/kunchoktashi/.nvm/versions/node/v22.9.0/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:134:13)
    at async handle (/Users/kunchoktashi/.nvm/versions/node/v22.9.0/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:89:17)
[error] 
[error] Error: There was an error deploying functions
